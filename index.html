<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>赛博纪元倒计时</title>
  <link rel="icon" href="测试图标\历史爱好者服务专设网站（网页图标）.ico" type="image/x-icon">
  <link rel="shortcut icon" href="测试图标\历史爱好者爱好者专设网站（网页图标）.ico" type="image/x-icon">
  <!-- 引入Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- 引入Font Awesome -->
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
  
  <!-- 配置Tailwind自定义颜色和字体 -->
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            'cyber-yellow': '#FFD700',
            'cyber-light': '#808080', // 浅蓝色背景
            'cyber-white': '#F0F0F0',
            'cyber-dark': '#0A0A0F',
            'cyber-gray': '#1A1A2E',
            primary: '#165DFF',
            secondary: '#FFD166',
          },
          fontFamily: {
            cyber: ['Orbitron', 'sans-serif', 'system-ui'],
          },
        },
      }
    }
  </script>
  
  <!-- 自定义工具类 -->
  <style type="text/tailwindcss">
    @layer utilities {
      .text-shadow-glow {
        text-shadow: 0 0 10px rgba(255, 215, 0, 0.8), 
                     0 0 20px rgba(255, 215, 0, 0.5),
                     0 0 30px rgba(255, 215, 0, 0.3);
      }
      .text-shadow-glow-white {
        text-shadow: 0 0 10px rgba(240, 240, 240, 0.8), 
                     0 0 20px rgba(240, 240, 240, 0.5);
      }
      .digit-glitch {
        position: relative;
        display: inline-block;
      }
      .scanline {
        background: linear-gradient(to bottom, 
          rgba(255,255,255,0) 0%,
          rgba(255,255,255,0.15) 50%,
          rgba(255,255,255,0) 100%);
        position: absolute;
        width: 100%;
        height: 3px;
        pointer-events: none;
        z-index: 5;
      }
      .noise {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.1'/%3E%3C/svg%3E");
        opacity: 0.05;
        pointer-events: none;
        z-index: 10;
      }
      .music-popup {
        transform: translateY(100px);
        opacity: 0;
        transition: transform 0.3s ease, opacity 0.3s ease;
      }
      .music-popup.show {
        transform: translateY(0);
        opacity: 1;
      }
    }
    
    @keyframes scanline-move {
      0% { top: -10%; }
      100% { top: 100%; }
    }
    
    @keyframes digit-flicker {
      0%, 100% { opacity: 1; transform: translateX(0); }
      20% { opacity: 0.6; transform: translateX(-2px); }
      40% { opacity: 0.8; transform: translateX(2px); }
      60% { opacity: 0.4; transform: translateX(-1px); }
      80% { opacity: 0.7; transform: translateX(1px); }
    }
    
    .animate-digit-flicker {
      animation: digit-flicker 0.3s ease-in-out;
    }

    /* 暗色模式全局样式 */
    body.dark-mode {
        background-color: #121212;
        color: #e0e0e0;
    }

    body.dark-mode header {
        background-color: #165DFF;
    }
  </style>
  
  <!-- 引入赛博朋克风格字体 -->
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
</head>

<body class="font-cyber transition-colors duration-500 bg-cyber-light text-cyber-dark dark:bg-cyber-dark dark:text-cyber-white min-h-screen overflow-x-hidden relative">
  <!-- 噪点效果 -->
  <div class="noise dark:opacity-0.15"></div>
  
  <!-- 扫描线容器 -->
  <div id="scanline-container" class="fixed inset-0 pointer-events-none z-40"></div>
  
  <!-- 创建扫描线 -->
  <script>
    // 创建多条扫描线
    const scanlineContainer = document.getElementById('scanline-container');
    for (let i = 0; i < 3; i++) {
      const scanline = document.createElement('div');
      scanline.classList.add('scanline');
      scanline.style.animation = `scanline-move ${10 + i * 5}s linear infinite`;
      scanline.style.animationDelay = `${i * 2}s`;
      scanlineContainer.appendChild(scanline);
    }
  </script>
  
  <!-- 背景图容器 -->
  <div id="bg-image" class="fixed inset-0 z-0 opacity-20 dark:opacity-10 transition-opacity duration-1000 bg-cover bg-center"></div>
  
  <!-- 背景音乐 -->
  <audio id="bg-music" preload="none"></audio>

  <!-- 音乐信息弹窗 -->
  <div id="music-popup" class="music-popup fixed bottom-8 right-8 w-64 md:w-80 bg-cyber-dark/90 dark:bg-cyber-white/10 backdrop-blur-sm p-4 rounded-lg border border-cyber-yellow shadow-lg z-50">
    <div class="flex justify-between items-center mb-3">
      <h3 class="text-lg font-bold text-cyber-yellow text-shadow-glow">【站嵌音乐】</h3>
      <button id="close-popup" class="text-cyber-white hover:text-cyber-yellow transition-colors">
        <i class="fa fa-times"></i>
      </button>
    </div>
    <div class="space-y-2 text-sm text-cyber-white/90 dark:text-cyber-white/90">
      <p><span class="text-cyber-yellow/80">绑定时间:</span> <span id="bind-time">2025-07-30</span></p>
      <p><span class="text-cyber-yellow/80">续播时间:</span> <span id="bind-time">2025-07-30~2077-01-01</span></p>
      <p><span class="text-cyber-yellow/80">绑定音乐:</span> <span id="current-music">BGM1.mp3</span></p>
      <p><span class="text-cyber-yellow/80">播放计时:</span> <span id="play-time">00:00</span></p>
    </div>
  </div>

  <!-- 顶部导航栏 -->
  <header class="bg-primary text-white shadow-lg relative z-20">
      <div class="container mx-auto px-4 py-4">
          <div class="flex flex-col md:flex-row items-center justify-between h-full">
              <!-- 左侧跳转链接 - 垂直居中 -->
              <div class="flex items-center mb-3 md:mb-0">
                  <a href="https://silvermoon-2025.github.io/historyloverweb/" class="flex items-center hover:opacity-90 transition-opacity">
                      <i class="fa fa-book text-2xl mr-2"></i>
                      <span class="text-xl font-bold">历史爱好者服务专设网站</span>
                  </a>
              </div>
              
              <!-- 右侧内容区：网站标题 - 垂直居中 -->
              <div class="flex items-center space-x-2">
                  <i class="fa fa-clock-o text-secondary text-2xl"></i>
                  <h1 class="text-xl md:text-2xl font-bold tracking-tight">赛博纪元倒计时</h1>
              </div>
          </div>
      </div>
  </header>

  <!-- 控制按钮区域 - 在置顶栏下方，右侧位置，向下移动 -->
  <div class="flex justify-end mt-2 mr-4 relative z-20">
      <div class="flex space-x-2">
          <!-- 音乐播放按钮 -->
          <button id="music-toggle" class="w-12 h-12 rounded-full bg-cyber-yellow text-cyber-dark flex items-center justify-center hover:bg-opacity-80 transition-all duration-300">
    <i class="fa fa-play" id="music-icon"></i>
</button>
          
          <!-- 夜间模式切换按钮 -->
          <button id="theme-toggle" class="w-12 h-12 rounded-full flex items-center justify-center bg-cyber-yellow text-cyber-dark hover:bg-opacity-80 transition-all duration-300 shadow-lg hover:shadow-cyber-yellow/30 dark:bg-cyber-gray dark:text-cyber-yellow">
              <i class="fa fa-moon-o dark:hidden"></i>
              <i class="fa fa-sun-o hidden dark:inline-block"></i>
          </button>
      </div>
  </div>

  <!-- 主内容区 -->
  <div class="relative z-10 container mx-auto px-4 py-16 flex flex-col items-center justify-center min-h-screen">    
    <!-- 标题 -->
    <h1 class="text-[clamp(2rem,5vw,4rem)] font-bold mb-12 text-center text-cyber-yellow text-shadow-glow dark:text-cyber-yellow">
      Cyberpunk<span class="text-cyber-white dark:text-cyber-white text-shadow-glow-white">2077</span>
    </h1>
    
    <!-- 倒计时容器 -->
    <div class="bg-cyber-dark/80 dark:bg-cyber-white/10 backdrop-blur-sm p-8 rounded-lg border-2 border-cyber-yellow shadow-[0_0_15px_rgba(255,215,0,0.5)] dark:shadow-[0_0_20px_rgba(255,215,0,0.3)] w-full max-w-4xl">
      <div id="countdown" class="grid grid-cols-1 md:grid-cols-3 gap-4 md:gap-8">
        <!-- 年 -->
        <div class="flex flex-col items-center">
          <div class="text-[clamp(2rem,8vw,5rem)] font-bold text-cyber-yellow text-shadow-glow digit-glitch" id="years">00</div>
          <div class="text-sm md:text-base uppercase tracking-wider mt-2 text-cyber-white dark:text-cyber-white">年</div>
        </div>
        <!-- 月 -->
        <div class="flex flex-col items-center">
          <div class="text-[clamp(2rem,8vw,5rem)] font-bold text-cyber-yellow text-shadow-glow digit-glitch" id="months">00</div>
          <div class="text-sm md:text-base uppercase tracking-wider mt-2 text-cyber-white dark:text-cyber-white">月</div>
        </div>
        <!-- 日 -->
        <div class="flex flex-col items-center">
          <div class="text-[clamp(2rem,8vw,5rem)] font-bold text-cyber-yellow text-shadow-glow digit-glitch" id="days">00</div>
          <div class="text-sm md:text-base uppercase tracking-wider mt-2 text-cyber-white dark:text-cyber-white">日</div>
        </div>
      </div>
    </div>
    
    <!-- 备注文字 -->
    <div class="mt-12 text-center max-w-2xl px-4">
      <p class="text-cyber-dark/80 dark:text-cyber-white/80 text-lg md:text-xl leading-relaxed">
        距离2077年还有一段漫长的旅程，科技正在重塑我们的未来，现实与虚拟的边界日益模糊。准备好迎接那个充满可能性与挑战的世界了吗？
      </p>
    </div>
  </div>

  <!-- 页脚 -->
  <footer class="bg-primary text-white mt-12 py-6 relative z-20">
      <div class="container mx-auto px-4">
          <div class="flex flex-col md:flex-row justify-between items-center">
              <div class="mb-4 md:mb-0">
                  <p class="text-lg font-semibold">赛博纪元倒计时</p>
                  <p class="text-sm text-white/80 mt-1">本网站仅供查看倒计时而用</p>
              </div>
              <div class="text-right">
                  <p class="text-sm">
                      [发布地] 中国-北京<br>
                      [网站创建时间] 2025年7月30日<br>
                      [网页名称] 赛博纪元倒计时<br>
                      [特别鸣谢] 我不是徐某人（QQ）
                  </p>
              </div>
          </div>
          <div class="mt-6 pt-4 border-t border-white/20 text-center text-sm text-white/70">
              <p>© 2025 赛博纪元倒计时</p>
          </div>
      </div>
  </footer>

  <script>
    // 音乐列表 - 按顺序播放
    const musicList = [
        "BGM1.mp3",  // 确保这些文件与HTML在同一目录
        "BGM2.mp3",
        "BGM3.mp3"
    ];
    
    // 音乐信息 - 可以根据实际情况修改
    const musicInfo = [
        { name: "I Really Want to Stay at Your House - Rosa Walton,Hallie Coggins", bindTime: "2025-07-30" },
        { name: "The Rebel Path - P.T. Adamczyk", bindTime: "2025-07-30" },
        { name: "V - Marcin Przybyłowicz", bindTime: "2025-07-30" }
    ];
    
    let currentIndex = 0;  // 当前播放索引
    let isPlaying = false; // 播放状态
    let playInterval;      // 播放时间更新间隔
    
    const audio = document.getElementById('bg-music');
    const btn = document.getElementById('music-toggle');
    const icon = document.getElementById('music-icon');
    const musicPopup = document.getElementById('music-popup');
    const closePopup = document.getElementById('close-popup');
    const currentMusic = document.getElementById('current-music');
    const bindTime = document.getElementById('bind-time');
    const playTime = document.getElementById('play-time');

    // 初始化第一首音乐
    audio.src = musicList[currentIndex];
    updateMusicInfo();

    // 按钮点击事件
    btn.addEventListener('click', function() {
        // 点击动画
        btn.style.transform = 'scale(0.9)';
        setTimeout(() => {
            btn.style.transform = 'scale(1)';
        }, 150);

        if (isPlaying) {
            // 暂停播放
            audio.pause();
            icon.className = 'fa fa-play';
            isPlaying = false;
            clearInterval(playInterval);
            musicPopup.classList.remove('show');
        } else {
            // 开始播放
            audio.play().then(() => {
                icon.className = 'fa fa-pause';
                isPlaying = true;
                musicPopup.classList.add('show');
                updatePlayTime();
                playInterval = setInterval(updatePlayTime, 1000);
            }).catch(error => {
                console.log('播放失败:', error);
                alert('请检查音乐文件是否存在并再次点击播放');
            });
        }
    });

    // 关闭弹窗
    closePopup.addEventListener('click', function() {
        musicPopup.classList.remove('show');
    });

    // 当前音乐播放结束时，自动切换到下一首
    audio.addEventListener('ended', function() {
        // 切换到下一首
        currentIndex = (currentIndex + 1) % musicList.length;
        audio.src = musicList[currentIndex];
        audio.load();
        updateMusicInfo();
        
        // 自动播放下一首
        audio.play().then(() => {
            icon.className = 'fa fa-pause';
            isPlaying = true;
            updatePlayTime();
            playInterval = setInterval(updatePlayTime, 1000);
        }).catch(e => {
            console.log('切换音乐失败:', e);
            icon.className = 'fa fa-play';
            isPlaying = false;
            clearInterval(playInterval);
        });
    });

    // 更新音乐信息
    function updateMusicInfo() {
        currentMusic.textContent = musicInfo[currentIndex].name || musicList[currentIndex];
        bindTime.textContent = musicInfo[currentIndex].bindTime || '2025-07-30 18:00';
        playTime.textContent = '00:00';
    }

    // 更新播放时间
    function updatePlayTime() {
        const minutes = Math.floor(audio.currentTime / 60);
        const seconds = Math.floor(audio.currentTime % 60);
        playTime.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
    }

    // 目标日期：2077年1月1日
    const targetDate = new Date('2077-01-01T00:00:00').getTime();
    
    // DOM元素
    const yearsElement = document.getElementById('years');
    const monthsElement = document.getElementById('months');
    const daysElement = document.getElementById('days');
    const themeToggle = document.getElementById('theme-toggle');
    const bgImage = document.getElementById('bg-image');
    
    // 背景图片路径设置（使用正斜杠作为路径分隔符）
    const DAY_BACKGROUND_IMAGE = "夜之城（日间）.jpeg";
    const NIGHT_BACKGROUND_IMAGE = "夜之城（夜间）.jpg";
    
    // 检查本地存储的主题设置并设置初始背景图片
    if (localStorage.getItem('theme') === 'dark' || 
        (!localStorage.getItem('theme') && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
      document.documentElement.classList.add('dark');
      document.body.classList.add('dark-mode');
      bgImage.style.backgroundImage = `url(${NIGHT_BACKGROUND_IMAGE})`;
    } else {
      document.documentElement.classList.remove('dark');
      document.body.classList.remove('dark-mode');
      bgImage.style.backgroundImage = `url(${DAY_BACKGROUND_IMAGE})`;
    }
    
    // 切换主题
    themeToggle.addEventListener('click', () => {
      const isDark = document.documentElement.classList.toggle('dark');
      document.body.classList.toggle('dark-mode', isDark);
      localStorage.setItem('theme', isDark ? 'dark' : 'light');
      
      // 切换背景图片
      if (isDark) {
        bgImage.style.backgroundImage = `url(${NIGHT_BACKGROUND_IMAGE})`;
      } else {
        bgImage.style.backgroundImage = `url(${DAY_BACKGROUND_IMAGE})`;
      }
    });
    
    // 计算两个日期之间的年、月、日差异
    function getDateDiff(startDate, endDate) {
      let years = endDate.getFullYear() - startDate.getFullYear();
      let months = endDate.getMonth() - startDate.getMonth();
      let days = endDate.getDate() - startDate.getDate();
      
      // 调整月份和年份
      if (days < 0) {
        months--;
        // 获取上一个月的天数
        const prevMonth = new Date(endDate.getFullYear(), endDate.getMonth(), 0);
        days += prevMonth.getDate();
      }
      
      if (months < 0) {
        years--;
        months += 12;
      }
      
      return { years, months, days };
    }
    
    // 为数字添加频闪效果
    function addFlickerEffect(element) {
      element.classList.add('animate-digit-flicker');
      setTimeout(() => {
        element.classList.remove('animate-digit-flicker');
      }, 300);
    }
    
    // 数字错乱效果
    function addGlitchEffect(element) {
      const originalText = element.textContent;
      const length = originalText.length;
      
      // 显示随机数字
      element.textContent = Math.random().toString().slice(2, 2 + length);
      addFlickerEffect(element);
      
      // 短暂延迟后恢复
      setTimeout(() => {
        element.textContent = originalText;
      }, 100 + Math.random() * 200);
    }
    
    // 更新倒计时
    function updateCountdown() {
      const now = new Date();
      const target = new Date('2077-01-01T00:00:00');
      const diff = getDateDiff(now, target);
      
      // 更新DOM
      yearsElement.textContent = diff.years.toString().padStart(2, '0');
      monthsElement.textContent = diff.months.toString().padStart(2, '0');
      daysElement.textContent = diff.days.toString().padStart(2, '0');
    }
    
    // 随机对数字应用效果
    function randomDigitEffects() {
      const elements = [yearsElement, monthsElement, daysElement];
      
      // 20%的概率触发效果
      if (Math.random() < 0.2) {
        const randomElement = elements[Math.floor(Math.random() * elements.length)];
        
        // 50%概率是简单频闪，50%概率是数字错乱
        if (Math.random() < 0.5) {
          addFlickerEffect(randomElement);
        } else {
          addGlitchEffect(randomElement);
        }
      }
    }
    
    // 初始化倒计时
    updateCountdown();
    setInterval(updateCountdown, 60000); // 每分钟更新一次
    setInterval(randomDigitEffects, 2000 + Math.random() * 3000); // 随机效果
    
    // 点击页面允许播放音乐
    document.body.addEventListener('click', () => {
      if (bgMusic.src && bgMusic.paused) {
        bgMusic.play().catch(e => console.log('用户交互后尝试播放音乐'));
      }
    }, { once: true });
  </script>
</body>
</html>
